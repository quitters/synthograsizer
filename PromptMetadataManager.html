<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prompt Metadata Manager</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="about-navbar" style="max-width:700px;margin:32px auto 0 auto;display:flex;justify-content:center;gap:32px;font-family:'Inter','Roboto Mono',monospace;font-size:1.07em;position:relative;z-index:10;">
      <div class="dropdown" style="position:relative;">
        <a href="index.html" class="dropbtn" style="color:#5e60ce;text-decoration:none;font-weight:600;">Projects &#x25BC;</a>
        <div class="dropdown-content" style="display:none;position:absolute;left:0;top:100%;background:#fff;border-radius:0 0 10px 10px;box-shadow:0 4px 16px rgba(94,96,206,0.10);min-width:230px;padding:8px 0;">
          <a href="index.html" style="color:#5e60ce;text-decoration:none;display:block;padding:10px 24px;font-weight:500;">Synthograsizer (main)</a>
          <a href="SynthograsizerDAW.html" style="color:#5e60ce;text-decoration:none;display:block;padding:10px 24px;font-weight:500;">SynthograsizerDAW</a>
          <a href="PromptMetadataManager.html" style="color:#5e60ce;text-decoration:none;display:block;padding:10px 24px;font-weight:500;">Prompt Metadata Manager</a>
          <a href="FunStuff.html" style="color:#5e60ce;text-decoration:none;display:block;padding:10px 24px;font-weight:500;">Fun Stuff</a>
        </div>
      </div>
      <a href="https://linktr.ee/quittersarts" target="_blank" rel="noopener" style="color:#5e60ce;text-decoration:none;font-weight:600;">Art</a>
      <a href="about.html" style="color:#5e60ce;text-decoration:none;font-weight:600;">About/Contact</a>
    </nav>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        var dropdown = document.querySelector('.dropdown');
        var btn = dropdown.querySelector('.dropbtn');
        var content = dropdown.querySelector('.dropdown-content');
        btn.addEventListener('mouseenter', function() { content.style.display = 'block'; });
        btn.addEventListener('focus', function() { content.style.display = 'block'; });
        dropdown.addEventListener('mouseleave', function() { content.style.display = 'none'; });
        document.body.addEventListener('click', function(e) { if (!dropdown.contains(e.target)) { content.style.display = 'none'; } });
      });
    </script>
    <div class="about-header">Prompt Metadata Manager</div>
    <div class="about-content">
      <p>This page will host tools for managing, annotating, and organizing prompt metadata for generative AI workflows.</p>
      <section style="margin: 36px 0 48px 0;max-width:700px;">
        <h2 style="font-size:1.15em;margin-bottom:0.5em;">PNG Metadata Extractor</h2>
        <p style="margin-bottom:1em;">Upload a PNG image generated by an AI art tool to view its embedded prompt and metadata.</p>
        <input type="file" id="pngInput" accept="image/png" style="margin-bottom:1em;" />
        <div id="metadataResult" style="background:#f8f9fa;border:1.5px solid #e2e8f0;border-radius:10px;padding:18px 22px;min-height:60px;font-size:1.04em;"></div>
      </section>
    </div>
    <script src="metadata_extractor.js"></script>
    <script>
      const input = document.getElementById('pngInput');
      const result = document.getElementById('metadataResult');
      input.addEventListener('change', async (e) => {
        const file = e.target.files[0];
        if (!file) return;
        if (!file.name.endsWith('.png')) {
          result.innerHTML = '<span style="color:#c00;">Please upload a PNG file.</span>';
          return;
        }
        const arrayBuffer = await file.arrayBuffer();
        try {
          const meta = window.extractAIMetadataFromPNG(arrayBuffer);
          let html = '';
          if (meta.prompt) html += `<div style='display:flex;align-items:center;gap:8px;'><b>Prompt:</b> <span id='promptText' style='color:#3a3;flex:1;'>${meta.prompt}</span><button id='copyPromptBtn' style='padding:3px 12px;font-size:0.98em;background:#e9eafc;color:#5e60ce;border:1px solid #bfc4f6;border-radius:6px;cursor:pointer;transition:background 0.15s;'>Copy</button></div>`;
          if (meta.parameters && meta.parameters.length > 0) {
            html += `<div style='margin:8px 0 0 0;'><b>Parameters:</b><ul style='margin:6px 0 0 18px;padding:0;font-size:1em;color:#444;'>`;
            for (const param of meta.parameters) {
              html += `<li style='margin-bottom:2px;'>${param}</li>`;
            }
            html += `</ul></div>`;
          }
          if (meta.model) html += `<div><b>Model:</b> <span style='color:#5e60ce;'>${meta.model}</span></div>`;
          if (meta.author) html += `<div><b>Author:</b> ${meta.author}</div>`;
          if (meta.width && meta.height) html += `<div><b>Dimensions:</b> ${meta.width} Ã— ${meta.height}</div>`;
          html += `<details style='margin-top:1em;'><summary style='cursor:pointer;'>Show raw metadata</summary><pre style='font-size:0.98em;background:#eef2fb;border-radius:6px;padding:10px 12px;margin-top:0.5em;'>${JSON.stringify(meta.raw, null, 2)}</pre></details>`;
          if (!html) html = '<span style="color:#c00;">No recognizable metadata found.</span>';
          result.innerHTML = html;
          // Copy button logic
          const copyBtn = document.getElementById('copyPromptBtn');
          if (copyBtn) {
            copyBtn.addEventListener('click', () => {
              const promptText = document.getElementById('promptText').innerText;
              navigator.clipboard.writeText(promptText).then(() => {
                copyBtn.textContent = 'Copied!';
                copyBtn.style.background = '#d2f8d2';
                setTimeout(() => {
                  copyBtn.textContent = 'Copy';
                  copyBtn.style.background = '#e9eafc';
                }, 1200);
              });
            });
          }
        } catch (err) {
          result.innerHTML = `<span style='color:#c00;'>Error reading metadata: ${err.message}</span>`;
        }
      });
    </script>
    <div class="about-footer">
      &copy; 2025 Synthograsizer. Licensed under <a href="https://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a>. Attribution required. Commercial use prohibited.<br>
      <a href="index.html">Back to Home</a>
    </div>
  </body>
</html>
